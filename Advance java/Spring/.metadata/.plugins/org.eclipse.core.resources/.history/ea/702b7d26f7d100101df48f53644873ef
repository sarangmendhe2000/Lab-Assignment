package com.demo.dao;

import java.util.List;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.jdbc.core.BeanPropertyRowMapper;
import org.springframework.jdbc.core.JdbcTemplate;
import org.springframework.stereotype.Repository;

import com.demo.bean.Product;

@Repository
public class ProductDaoImpl implements ProductDao {
	
	@Autowired
	
	private JdbcTemplate jdbcTemplate;
	
	
	
	@Override
	public boolean save(Product p) {
		
		int n = jdbcTemplate.update("insert into product1 values(? , ? , ? , ? , ?)" ,
				
				new Object[] { p.getPid() , p.getPname() , p.getQty() , p.getPrice() , p.getCid() }
				
				);
		
		return n>0;
	}



	@Override
	public List<Product> display() {
		
		List<Product> plist = jdbcTemplate.query("Select * from Product1 ", (rs,n)->{
			
			Product p = new Product();
			
			p.setPid(rs.getInt(1)); 
	        p.setPname(rs.getString(2)); 
	        p.setQty(rs.getInt(3)); 
	        p.setPrice(rs.getFloat(4)); 
	        p.setCid(rs.getInt(5));
	        
	        
	        return p;
			
		});
			
		return plist;
		
	}



	@Override
	public boolean modifyById(int id, double price) {
		
		int n =  jdbcTemplate.update("Update product1 set price= ? where id = ?",
				
				new Object[] {price , id}
		
		
				);
		
		return n>0;
	}



	@Override
	public boolean removeById(int id) {
		
		int n = jdbcTemplate.update("Delete from Product1 where id=? " , 
				
				new Object[] {id}
				);
		
		return n>0;
	}



	@Override
	public Product searchByProductId(int id) {
		
		@SuppressWarnings("deprecation")
		Product product= jdbcTemplate.queryForObject("Select * from Product1 where id = ? ",
				
				new Object[] { id },
				BeanPropertyRowMapper.newInstance(Product.class)
			
			
			
		);
		
		return product ;
	}



	@Override
	public List<Product> sortInAsc() {
		
		List<Product> plist = jdbcTemplate.query("Select * from product1 order by price" , (rs,n)->{
				 
				Product p = new Product();
				
			p.setPid(rs.getInt(1)); 
			p.setPname(rs.getString(2)); 
        	p.setQty(rs.getInt(3)); 
        	p.setPrice(rs.getFloat(4)); 
        	p.setCid(rs.getInt(5));
        
        
        return p;
		});
		
		return plist;
	}



	@Override
	public List<Product> displayByCid(int id) {
		
		jdbcTemplate.query("Select * from Product where cid = ? ", 
				
				new Object[] {id} , (rs,n)->{
					
					
					
				}
				}
				)
	}

}
